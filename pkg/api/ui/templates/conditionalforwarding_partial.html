{{if not .Enabled}}
<div class="feature-disabled">
    <p><strong>Conditional Forwarding is disabled</strong></p>
    <p class="text-muted">Add rules to automatically enable this feature</p>
</div>
{{end}}

{{if .Rules}}
<div class="conditionalforwarding-list">
    {{range .Rules}}
    <div class="forwarding-rule{{if not .Enabled}} rule-disabled{{end}}">
        <div class="rule-header">
            <div class="rule-title">
                <span class="rule-name">{{.Name}}</span>
                <span class="priority-badge">Priority: {{.Priority}}</span>
                {{if not .Enabled}}
                <span class="disabled-badge">Disabled</span>
                {{end}}
            </div>
            <div class="rule-actions">
                <button class="btn btn-danger btn-sm"
                        onclick="removeRule('{{.ID}}')"
                        title="Remove rule">
                    Remove
                </button>
            </div>
        </div>

        <div class="rule-details">
            <!-- Matching Conditions -->
            <div class="detail-section">
                <h5>Matches:</h5>
                {{if .Domains}}
                <div class="detail-row">
                    <span class="detail-label">Domains:</span>
                    <span class="detail-value">
                        {{range $i, $domain := .Domains}}{{if $i}}, {{end}}<code>{{$domain}}</code>{{end}}
                    </span>
                </div>
                {{end}}
                {{if .ClientCIDRs}}
                <div class="detail-row">
                    <span class="detail-label">Client Networks:</span>
                    <span class="detail-value">
                        {{range $i, $cidr := .ClientCIDRs}}{{if $i}}, {{end}}<code>{{$cidr}}</code>{{end}}
                    </span>
                </div>
                {{end}}
                {{if .QueryTypes}}
                <div class="detail-row">
                    <span class="detail-label">Query Types:</span>
                    <span class="detail-value">
                        {{range $i, $qtype := .QueryTypes}}{{if $i}}, {{end}}<span class="type-badge">{{$qtype}}</span>{{end}}
                    </span>
                </div>
                {{end}}
            </div>

            <!-- Upstream Configuration -->
            <div class="detail-section">
                <h5>Forwards to:</h5>
                <div class="detail-row">
                    <span class="detail-label">Upstreams:</span>
                    <span class="detail-value">
                        {{range $i, $upstream := .Upstreams}}{{if $i}}, {{end}}<code>{{$upstream}}</code>{{end}}
                    </span>
                </div>
                {{if .Timeout}}
                <div class="detail-row">
                    <span class="detail-label">Timeout:</span>
                    <span class="detail-value">{{.Timeout}}</span>
                </div>
                {{end}}
                {{if gt .MaxRetries 0}}
                <div class="detail-row">
                    <span class="detail-label">Max Retries:</span>
                    <span class="detail-value">{{.MaxRetries}}</span>
                </div>
                {{end}}
                {{if .Failover}}
                <div class="detail-row">
                    <span class="detail-label">Failover:</span>
                    <span class="detail-value">âœ“ Enabled</span>
                </div>
                {{end}}
            </div>
        </div>
    </div>
    {{end}}
</div>
{{else}}
<div class="empty-state">
    <p>No conditional forwarding rules configured</p>
    <p class="text-muted">Add rules to route DNS queries to specific upstreams</p>
</div>
{{end}}
